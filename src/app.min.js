let monthlyPowertChart,grandFinanceChart,last_known_scroll_position=0,angleToAzimuth=[],grandChartUpdated={},gridFirstYearDom={},gridYearlyDom={},grandSummaryDom={},initialDataDom={},profitabilityYear=0,vueMainInstances=[];const calcModel={powerLocale:"",powerLocaleSeasonsMonthly:"",angleLocale:"",yearsToShow:0,dollarValue:0,degradationMod:0,euroToDollarRatio:0,solarPanelDegradation:0,taxRate:0,preferedPower:{},roofAngle:{},navigation:{},regions:{},monthlyPowerGeneraion:[],selectedRegion:{},yearSummary:0,seasonConsumption:{summer:{},winter:{}},greenTariff:{},currentTariff:{},futureTariff:{},isCalcVisible:!0,isComplectationPricingVisible:!0,isIncomeGridFirstYearVisible:!0,isIncomeGridYearlyVisible:!0,isIncomeGridFinanceGraphVisible:!0,isInitialInfoVisible:!0},getAllData=e=>e(window._allData);let fetchDataForChart=e=>{let t=e.map(e=>e.name),i=[];return i[0]=e.map(e=>e.value),{labels:t,series:i}},updateChartData=(e,t)=>{let i=[],r=[];switch(i[0]=e.map(e=>Math.round(e.value)),t){case"MonthlyChart":if(!monthlyPowertChart)return;r=e.map(e=>calculatorApp.getMonthText(e.id,!0)),monthlyPowertChart.update({labels:r,series:i});break;case"GrandFinance":if(!grandFinanceChart)return;r=e.map(e=>e.name),grandFinanceChart.update({labels:r,series:i}),grandChartUpdated.GrandFinance=(new Date).getTime()}},generatePowerChart=e=>{let t=fetchDataForChart(e),i=$(window).width();i>500&&(i=500);let r={seriesBarDistance:5,width:i,height:200,showZLabels:!0};grandChartUpdated.MonthlyChart||(grandChartUpdated.MonthlyChart=(new Date).getTime()),(monthlyPowertChart=new Chartist.Bar(".ct-chart",t,r,[["screen and (max-width: 640px)",{seriesBarDistance:5,axisX:{labelInterpolationFnc:function(e){return e[0]}}}]])).eventEmitter.addEventHandler("created",e=>{})},generateFinanceChart=e=>{let t=fetchDataForChart(e),i=$(window).width();i>1024&&(i=1024),console.log(i);let r={seriesBarDistance:5,width:i,height:400,showZLabels:!1};grandChartUpdated.GrandFinance||(grandChartUpdated.MonthlyChart=(new Date).getTime()),(grandFinanceChart=new Chartist.Bar(".ct-chart.grand",t,r,[["screen and (max-width: 640px)",{seriesBarDistance:5,axisX:{labelInterpolationFnc:function(e){return e[0]}}}]])).eventEmitter.addEventHandler("created",e=>{})},generateAnglePicker=e=>{$("#anglepicker").anglepicker({min:e.min,max:e.max,snap:e.step,value:e.selectedAngle,clockwise:!1,change:function(t,i){e.selectedAngle!=i.value&&(e.selectedAngle=i.value)}})},generateCompass=e=>{var t=document.getElementById("jog_dial_house"),i=document.getElementById("jog_dial_one"),r=JogDial(i,{touchMode:"wheel",wheelSize:"120%",knobSize:"50px",minDegree:e.min,maxDegree:e.max,degreeStartAt:e.current,degreeStep:e.step});r.on("mousemove",function(i){i.target.degree;r.info.now.rotation>360?r.info.now.rotation=0:r.info.now.rotation<0&&(r.info.now.rotation=360),t.style.transform="rotate("+i.target.degree+"deg)",e.current=i.target.degree-e.offset}),r.on("start",function(i){t.style.transform="rotate("+e.current+"deg)",e.current=e.current-e.offset})},generateMonthToRegionRelation=(e,t,i)=>{i.forEach((i,r)=>{let a,n=e.filter(e=>e.id==r+1);n&&n.length>0&&(n=n[0],Object.keys(i).forEach(e=>{(a=t.filter(t=>t.id+""==e))&&a.length>0&&(a=a[0]).mod.push({mId:n.id,value:i[e]})}))})},generateUkraineMap=e=>{let t=document.getElementsByClassName("land"),i=(document.getElementById("country_title"),e=>{for(let t=0;t<e.length;t++)e[t].setAttribute("class","land")});for(el in t)t[el].onclick=function(){i(t),this.setAttribute("class","land active");let r=this.getAttribute("id"),a=e.regions.filter(e=>e.id==r);a&&a.length>0&&(e.selectedRegion=a[0])}},generateFinanceResultModel=e=>{for(let t=1;t<e.yearsToShow+1;t++)e.totalFinanceResult.push({index:t,name:t+"й",value:t-10})},creditApp=new Vue({el:"#credit-app",data:{isPopupActive:!1,dollarValue:0,creditOneTimeCommission:0,initialFee:{},creditTerm:{},avaliableBanks:[],bankSchemas:[],selectedBank:{},selectedPlan:{},selectedSchema:{main:{},second:{}},cachedSchemePeriods:{}},mixins:[window._localeMixin],computed:{selectedPlanComp:{get:function(){return this.selectedPlan},set:function(e){this.selectedPlan=e,this.creditTerm=this.selectedPlan.creditTerm,this.initialFee=this.selectedPlan.initialFee}},commission(){let e=complectationPricingApp.getComplectationPrice();return Math.round10(e*this.creditOneTimeCommission/100,-1)},selectedBankComp:{get:function(){return this.selectedBank},set:function(e){this.selectedBank=e,this.selectedSchema=this.setBankSchema(e.id)}},isApplyDisabled(){return this.getYearlyPercent()<=0}},methods:{creditSummary(e){let t=Math.round10(this.getMonthlyPayment("USD")*this.creditTerm.current+this.getInitialFee("USD")+this.getCommission("USD"),-1);switch(this.selectedPlan.selectedCreditSummary=t,e){case"UAH":return Math.round10(t*this.dollarValue,-1);case"USD":default:return t}},getMonthlyPayment(e){if(0==this.creditTerm.current||this.initialFee.current<this.initialFee.min||this.initialFee.current>this.initialFee.max)return 0;let t=this.getYearlyPercent()/12/100,i=this.creditTerm.current,r=t*Math.pow(1+t,i)/(Math.pow(1+t,i)-1),a=Math.round10(r*this.getCreditedMoney(),-1);switch(this.selectedPlan.selectedMonthlyPayment=a,e){case"UAH":return Math.round10(a*this.dollarValue,-1);case"USD":default:return a}},getCreditedMoney(){return this.selectedPlan.selectedCreditedMoney=this.getNormalPrice("USD")-this.getInitialFee("USD"),this.selectedPlan.selectedCreditedMoney},getNormalPrice(e){let t=complectationPricingApp.getComplectationPrice(),i=0;switch(this.selectedPlan.increaseInTotalValue>0&&0==complectationPricingApp.increaseInPrice?t+=i=t*this.selectedPlan.increaseInTotalValue/100:0==this.selectedPlan.increaseInTotalValue&&complectationPricingApp.increaseInPrice>0&&(t=complectationPricingApp.getComplectationPriceLocal()),e){case"UAH":return Math.round10(t*this.dollarValue,-1);case"USD":default:return t}},getCommission(e){if(0==this.creditTerm.current||this.initialFee.current<this.initialFee.min||this.initialFee.current>this.initialFee.max)return 0;let t=this.getNormalPrice("USD"),i=Math.round10((t-this.getInitialFee("USD"))*this.creditOneTimeCommission/100,-1);switch(this.selectedPlan.selectedCommission=i,e){case"UAH":return Math.round10(i*this.dollarValue,-1);case"USD":default:return i}},getInitialFee(e){if(0==this.creditTerm.current||this.initialFee.current<this.initialFee.min||this.initialFee.current>this.initialFee.max)return 0;let t=this.getNormalPrice("USD"),i=Math.round10(t*this.initialFee.current/100,-1);switch(this.selectedPlan.selectedInitialFeeDollars=i,e){case"UAH":return Math.round10(i*this.dollarValue,-1);case"USD":default:return i}},getYearlyPercent(){if(!this.selectedPlan.id)return 0;let e=this.creditTerm.current,t=this.selectedPlan.periods.filter(t=>e<=t.to&&e>=t.from),i=this.selectedPlan.firstPayments.filter(e=>this.initialFee.current>=e.from&&this.initialFee.current<=e.to);if(t.length>0&&i.length>0){let e=t[0].id,r=i[0].id,a=this.selectedPlan.percentPerYear.filter(t=>t.firstPid==r&&t.perId==e);return this.selectedPlan.selectedYearlyPercent=a.length>0?a[0].value:0,this.selectedPlan.selectedYearlyPercent}return 0},getSchemeForPeriod(e){if(!this.selectedSchema.main.percentPerYear)return{};if(!this.cachedSchemePeriods[e]){let t=this.selectedSchema.main.percentPerYear.filter(t=>t.perId==e),i=this.selectedSchema.second.percentPerYear.filter(t=>t.perId==e);this.cachedSchemePeriods[e]={main:t,second:i}}return this.cachedSchemePeriods[e]},getAvaliablePlans(){return[this.selectedSchema.main,this.selectedSchema.second]},setBankSchema(e){let t=this.bankSchemas.filter(t=>t.bId==e);if(t.length>0){return{main:t[0].isDependent?t[1]||{}:t[0],second:t[0].isDependent?t[0]:t[1]||{}}}},resetSelectedCreditPlan(){incomeGridApp.applySelectedCreditPlan({initialFee:{},creditTerm:{}}),this.selectedSchema={main:{},second:{}},this.selectedPlan={},this.selectedBank={},complectationPricingApp.increasePrice(0),this.isPopupActive=!1},applySelectedCreditPlan(){this.isApplyDisabled||(incomeGridApp.applySelectedCreditPlan(this.selectedPlan),complectationPricingApp.increasePrice(this.selectedPlan.increaseInTotalValue),this.isPopupActive=!1)},openPopup(){this.isPopupActive=!this.isPopupActive},selectBank(e){this.selectedSchema=this.setBankSchema(e.id)},setDependency(e){},validateFee(e){this.initialFee.current=parseInt(this.initialFee.current,10),8!=e.keyCode&&getAllData(e=>{Number.isNaN(this.initialFee.current)?this.initialFee.current=this.initialFee.default:this.initialFee.current>this.initialFee.max&&(this.initialFee.current=this.initialFee.max)})},validateTerm(e){this.creditTerm.current=parseInt(this.creditTerm.current,10),8!=e.keyCode&&getAllData(e=>{Number.isNaN(this.creditTerm.current)?this.creditTerm.current=this.creditTerm.default:this.creditTerm.current>this.creditTerm.max&&(this.creditTerm.current=this.creditTerm.max)})}},mounted(){getAllData(e=>{this.avaliableBanks=e.avaliableBanks,this.bankSchemas=e.bankSchemas,this.dollarValue=e.dollarValue,this.creditOneTimeCommission=e.creditOneTimeCommission})}});vueMainInstances.push(creditApp);let complectationPricingApp=new Vue({el:"#complectation-pricing-app",data:{avgPowerCableLength:0,increaseInPrice:0,selectedPricing:{ratio:{}},isDetailsActive:!1,preferedPower:calcModel.preferedPower,complectationPricing:[],eModules:[],selectedEModule:{},eFastening:[],selectedEFastening:{},webInverters:[],selectedwWebInverter:{},isComplectationPricingVisible:calcModel.isComplectationPricingVisible},mixins:[window._localeMixin],computed:{getCableLength:{get:function(){return Math.round(this.getModuleCount()*this.avgPowerCableLength)}}},methods:{getMonitoring(){if(!this.selectedPricing.id)return"";let e=this.getComplectationPricingText(this.selectedPricing.id,!0).filter(e=>"Мониторинг:"==e.label);return e.length>0?"включено":"не включено"},getComplectationPrice(e){e||(e=this.selectedPricing);let t=0,i=this.preferedPower.current*e.ratio.value*1e3;return this.increaseInPrice>0&&(t=i*this.increaseInPrice/100),Math.round(i+t)},getComplectationPriceLocal(e){return e||(e=this.selectedPricing),Math.round(this.preferedPower.current*e.ratio.value*1e3)},getModuleCount(){return Math.round(1e3*this.preferedPower.current/this.getModuleDescr().power)},getModuleDescr(){var e=this.eModules.filter(e=>e.complectionId==this.selectedPricing.id);return e[0]||{}},getFasteningDescr(){var e=this.eFastening.filter(e=>e.complectionId==this.selectedPricing.id);return e[0]||{}},getInverterDescr(){if(this.webInverters.length<=0)return{};if((e=this.webInverters.filter(e=>e.power>=this.preferedPower.current&&e.complectionId==this.selectedPricing.id))&&!(e.length<=0))return e[e.length-1];var e;return(e=this.webInverters.filter(e=>e.complectionId==this.selectedPricing.id))[0]||{}},onDetailsClick(e,t){e.id!=this.selectedPricing.id&&t&&this.onSelect(e),this.isDetailsActive=t},onSelect(e){this.clearSelections(),e.isSelected=!0,this.selectedPricing=e,this.selectedEModule=this.getModuleDescr(),this.selectedEFastening=this.getFasteningDescr(),this.selectedwWebInverter=this.getInverterDescr()},setPreferedPower(e){this.preferedPower=e},clearSelections(){this.complectationPricing.forEach(e=>{e.isSelected=!1})},isVisible(){return this.isComplectationPricingVisible},appear(e){this.isComplectationPricingVisible!=e&&(this.isComplectationPricingVisible=e)},increasePrice(e){this.increaseInPrice=e}},mounted(){getAllData(e=>{this.avgPowerCableLength=e.avgPowerCableLength,this.complectationPricing=e.complectationPricing,this.eModules=e.eModules,this.eFastening=e.eFastening,this.webInverters=e.webInverters,this.onSelect(this.complectationPricing[1])})}});vueMainInstances.push(complectationPricingApp);let incomeGridApp=new Vue({el:"#income-grids-app",data:{yearsToShow:0,dollarValue:0,euroToDollarRatio:0,solarPanelDegradation:0,taxRate:0,preferedPower:{},yearSummary:0,monthlyPowerGeneraion:[],totalFinanceResult:[],powerLocale:"",seasonConsumption:calcModel.seasonConsumption,currentTariff:{},greenTariff:{},futureTariff:{},powerLocaleSeasonsMonthly:"",isIncomeGridFirstYearVisible:calcModel.isIncomeGridFirstYearVisible,isIncomeGridYearlyVisible:calcModel.isIncomeGridYearlyVisible,isIncomeGridFinanceGraphVisible:calcModel.isIncomeGridFinanceGraphVisible,isInitialInfoVisible:calcModel.isInitialInfoVisible,selectedCreditPlan:{initialFee:{},creditTerm:{}}},mixins:[window._localeMixin],computed:{profitability(){if(this.canUpdate())return Math.round10((this.getTotalIncomeY(this.yearsToShow)-this.creditInvestment-this.futureInvestment)/(this.creditInvestment+this.futureInvestment)*100,-2)},avgMonthlyIncome(){if(!this.canUpdate())return;let e=(new Date).getFullYear(),t=this.totalFinanceResult.filter(t=>e+t.index==this.greenTariff.end);if(t.length>0){let e=0,i=0;for(let r=1;r<=t[0].index;r++)e+=this.getSaleIncomeY(r),i+=this.getSelfSavingY(r);let r=e+i;return Math.round10(r/(12*t[0].index),-2)}},recoupment(){if(this.canUpdate())return Math.round10(profitabilityYear+this.getTotalIncomeY(profitabilityYear)/(this.getTotalIncomeY(profitabilityYear)-this.getTotalIncomeY(profitabilityYear+1)),-1)},investment(){if(!this.canUpdate())return;let e=complectationPricingApp.getComplectationPrice();return this.totalFinanceResult[0]&&(this.totalFinanceResult[0].value=-e),Math.round10(e,-2)},futureInvestment(){return this.canUpdate()&&this.selectedCreditPlan.id?Math.round10(this.getFutureInvestmentRecursively(25,0),-2):0},creditInvestment(){return this.selectedCreditPlan.id?Math.round10(this.selectedCreditPlan.selectedInitialFeeDollars+this.selectedCreditPlan.selectedCommission,-2):this.investment},getFirstYearData(){return this.monthlyPowerGeneraion}},methods:{getFutureInvestmentRecursively(e,t){if(0==e)return t;let i=this.getCreditPaymentY(e);return 0==i?this.getFutureInvestmentRecursively(--e,t):(t+=i-this.getSaleIncomeY(e)-this.getSelfSavingY(e),this.getFutureInvestmentRecursively(--e,t>0?t:0))},getTotalIncomeY(e){if(this.canUpdate()){if(e){let t=Math.round10(this.getTotalIncomeRecursively(e,-this.creditInvestment),-2);if(t<0&&profitabilityYear++,this.totalFinanceResult[e]){let i=this.totalFinanceResult[e].value;this.totalFinanceResult[e].value=t,e==this.yearsToShow&&i!=t&&(this.totalFinanceResult[0].value=-this.creditInvestment,updateChartData(this.totalFinanceResult,"GrandFinance"))}return Math.round10(t,-2)}return Math.round10(this.monthlyPowerGeneraion.sum(e=>this.getSaleIncomeM(e)+this.getSelfSavingM(e)-this.getCreditPaymentM(e)),-2)}},getTotalIncomeRecursively(e,t){(new Date).getFullYear();if(e<1)return t;let i=this.getSaleIncomeY(e)+this.getSelfSavingY(e)-this.getCreditPaymentY(e);return this.getTotalIncomeRecursively(--e,t+i)},getTotalIncomeM(e){if(this.canUpdate())return Math.round10(this.getSaleIncomeM(e)+this.getSelfSavingM(e)-this.getCreditPaymentM(e),-2)},getCreditPaymentY(e){if(this.canUpdate()){if(!this.selectedCreditPlan.id)return 0;if(e){let t=12*e;if(this.selectedCreditPlan.creditTerm.current-t<=-12)return 0;if(this.selectedCreditPlan.creditTerm.current>t)return Math.round10(12*this.selectedCreditPlan.selectedMonthlyPayment,-2);{let e=12-(t-this.selectedCreditPlan.creditTerm.current);return Math.round10(this.selectedCreditPlan.selectedMonthlyPayment*e,-2)}}return Math.round10(this.monthlyPowerGeneraion.sum(e=>this.getCreditPaymentM(e)),-2)}},getCreditPaymentM(e){if(this.canUpdate())return this.selectedCreditPlan.id&&e?this.selectedCreditPlan.creditTerm?Math.round10(this.selectedCreditPlan.creditTerm.current-e.id>=0?this.selectedCreditPlan.selectedMonthlyPayment:0,-2):void 0:0},getSelfSavingY(e){if(this.canUpdate())return e?Math.round10(this.getSelfSavingY()/this.getCurrentTariffY()*this.getCurrentTariffY(e),-2):Math.round10(this.monthlyPowerGeneraion.sum(e=>{return this.getWebSaleM(e)>0?this.getSeasonConsumptionM(e)*this.getCurrentTariffM():e.value*this.getCurrentTariffM()}),-2)},getSelfSavingM(e){if(!this.canUpdate())return;let t=this.getWebSaleM(e);return Math.round10(t>0?this.getSeasonConsumptionM(e)*this.getCurrentTariffM():e.value*this.getCurrentTariffM(),-2)},getSaleIncomeY(e){if(this.canUpdate())return e?Math.round10(this.getRawIncomeY(e)-this.getTaxRateY(e),-2):Math.round10(this.monthlyPowerGeneraion.sum(e=>{return this.getRawIncomeM(e)-this.getTaxRateM(e)}),-2)},getSaleIncomeM(e){if(!this.canUpdate())return;let t=this.getRawIncomeM(e);return Math.round10(t-this.getTaxRateM(e),-2)},getTaxRateY(e){if(this.canUpdate())return e?Math.round10(this.getRawIncomeY(e)/100*this.taxRate,-2):Math.round10(this.monthlyPowerGeneraion.sum(e=>{return this.getRawIncomeM(e)/100*this.taxRate}),-2)},getTaxRateM(e){if(!this.canUpdate())return;let t=this.getRawIncomeM(e);return Math.round10(t/100*this.taxRate,-2)},getRawIncomeY(e){if(this.canUpdate())return e?Math.round10(this.getWebSaleY(e)*this.getGreenTariffY(e),-2):Math.round10(this.monthlyPowerGeneraion.sum(e=>this.getWebSaleM(e)*this.getGreenTariffM()),-2)},getRawIncomeM(e){if(this.canUpdate())return Math.round10(this.getWebSaleM(e)*this.getGreenTariffM(),-2)},getCurrentTariffY(e){if(this.canUpdate())return e?Math.round10(this.getCurrentTariffYRecursively(e,this.currentTariff.value/this.dollarValue),-5):Math.round10(this.currentTariff.value/this.dollarValue,-5)},getCurrentTariffYRecursively(e,t){let i=(new Date).getFullYear();if(e<=1)return t;if(i+e>this.futureTariff.end+1)return this.getCurrentTariffYRecursively(--e,t);let r=this.currentTariff.value/this.dollarValue,a=(this.futureTariff.value-r)/(this.futureTariff.end-i);return this.getCurrentTariffYRecursively(--e,t+a)},getCurrentTariffM(){if(this.canUpdate())return Math.round10(this.currentTariff.value/this.dollarValue,-5)},getGreenTariffY(e){if(!this.canUpdate())return;let t=(new Date).getFullYear();return t+e<=this.greenTariff.end?this.getGreenTariffM():this.getCurrentTariffY(e)},getGreenTariffM(){if(this.canUpdate())return Math.round10(this.greenTariff.value*this.euroToDollarRatio,-5)},getWebSaleY(e){if(!this.canUpdate())return;if(e){let t=this.getWebSaleRecursively(e,this.getWebSaleY());return t>0?t:0}let t=this.monthlyPowerGeneraion.sum(e=>{let t=e.value-this.getSeasonConsumptionM(e);return t>0?t:0});return Math.round10(t,-2)},getWebSaleRecursively(e,t){if(e<=1)return t;let i=this.getYearSummary(e-1)-this.getYearSummary(e);return this.getWebSaleRecursively(--e,t-i)},getWebSaleM(e){if(!this.canUpdate())return;let t=e.value-this.getSeasonConsumptionM(e);return t>0?t:0},getSeasonConsumptionY(){if(this.canUpdate())return Math.round(6*this.seasonConsumption.summer.current+6*this.seasonConsumption.winter.current)},getSeasonConsumptionM(e){if(this.canUpdate())switch(e.id){case 4:case 5:case 6:case 7:case 8:case 9:return this.seasonConsumption.summer.current;case 1:case 2:case 3:case 10:case 11:case 12:return this.seasonConsumption.winter.current}},setDependency(e){this.yearSummary=e.yearSummary,this.monthlyPowerGeneraion=e.monthlyPowerGeneraion,this.preferedPower=e.preferedPower},getYearSummary(e){if(this.canUpdate())return Math.round(this.getYearSummaryRecursively(e,this.yearSummary))},getYearSummaryRecursively(e,t){if(e<=1)return t;let i=t/100*this.solarPanelDegradation;return this.getYearSummaryRecursively(--e,t-i)},setYearSummary(e){this.yearSummary=e},appearGraph(e){this.isIncomeGridFinanceGraphVisible!=e&&(this.isIncomeGridFinanceGraphVisible=e)},isVisibleYearly(){return this.isIncomeGridYearlyVisible},appearYearly(e){this.isIncomeGridYearlyVisible!=e&&(this.isIncomeGridYearlyVisible=e)},isVisibleFirstYear(){return this.isIncomeGridFirstYearVisible},appearFirstYear(e){this.isIncomeGridFirstYearVisible!=e&&(e&&this.$forceUpdate(),this.isIncomeGridFirstYearVisible=e)},appearInitial(e){this.isInitialInfoVisible!=e&&(e&&this.$forceUpdate(),this.isInitialInfoVisible=e)},canUpdate(){return this.isIncomeGridYearlyVisible||this.isIncomeGridFirstYearVisible||this.isIncomeGridFinanceGraphVisible||this.isInitialInfoVisible},applySelectedCreditPlan(e){this.selectedCreditPlan=e},showYearlyTable:()=>$(window).width()>1024},beforeUpdate(){profitabilityYear=0},mounted(){getAllData(e=>{this.yearsToShow=e.yearsToShow,this.dollarValue=e.dollarValue,this.euroToDollarRatio=e.euroToDollarRatio,this.solarPanelDegradation=e.solarPanelDegradation,this.taxRate=e.taxRate,this.yearSummary=e.yearSummary,this.monthlyPowerGeneraion=e.monthlyPowerGeneraion,this.powerLocale=e.powerLocale,this.currentTariff=e.currentTariff,this.greenTariff=e.greenTariff,this.futureTariff=e.futureTariff,this.powerLocaleSeasonsMonthly=e.powerLocaleSeasonsMonthly,this.preferedPower=e.preferedPower,this.totalFinanceResult=e.totalFinanceResult,this.seasonConsumption=e.seasonConsumption,generateFinanceResultModel(this),generateFinanceChart(this.totalFinanceResult)})}});vueMainInstances.push(incomeGridApp);let calculatorApp=new Vue({el:"#solar-calculator-app",data:calcModel,mixins:[window._localeMixin],computed:{summary(){return this.monthlyPowerGeneraion&&this.monthlyPowerGeneraion.length>0&&this.preferedPower.current>0&&(this.calculateMonthlyPower(),this.yearSummary=Math.round10(this.monthlyPowerGeneraion.reduce((e,t)=>Number.isInteger(e.value)&&Number.isInteger(t.value)?e.value+t.value:!Number.isInteger(e.value)&&Number.isInteger(t.value)?e+t.value:Number.isInteger(e.value)&&!Number.isInteger(t.value)?e.value+t:e+t),-2),updateChartData(this.monthlyPowerGeneraion,"MonthlyChart")),incomeGridApp.setYearSummary(this.yearSummary),this.yearSummary},powerSlide:{get:function(){return this.preferedPower.current},set:function(e){e<this.preferedPower.current?this.preferedPower.current-=this.preferedPower.step:this.preferedPower.current+=this.preferedPower.step}},selectedRegionLabel:{get:function(){return(this.selectedRegion.name||"").toUpperCase()}}},methods:{calculateMonthlyPower(){this.monthlyPowerGeneraion.forEach(e=>{let t=this.selectedRegion.mod.filter(t=>t.mId==e.id);t&&t.length>0&&(t=t[0],e.value=Math.round(t.value*e.days*this.getAngleMod()*this.preferedPower.current*this.degradationMod))})},selectRegion(e){this.selectedRegion=e},getAngleMod(){let e=angleToAzimuth.filter(e=>e.navA==Math.abs(this.navigation.current)&&e.roofA==this.roofAngle.selectedAngle);return e&&e.length>0?e[0].mod:1},isVisible(){return this.isCalcVisible},appear(e){this.isCalcVisible!=e&&(this.isCalcVisible=e)},validateInput(e){this.preferedPower.current=parseInt(this.preferedPower.current,10),8!=e.keyCode&&getAllData(e=>{Number.isNaN(this.preferedPower.current)?this.preferedPower.current=this.preferedPower.default:this.preferedPower.current>this.preferedPower.max&&(this.preferedPower.current=this.preferedPower.max)})}},mounted(){getAllData(e=>{generateMonthToRegionRelation(e.monthlyPowerGeneraion,e.regions,e.monthToRegions),this.powerLocale=e.powerLocale,this.degradationMod=e.degradationMod,this.powerLocaleSeasonsMonthly=e.powerLocaleSeasonsMonthly,this.preferedPower=e.preferedPower,this.roofAngle=e.roofAngle,this.navigation=e.navigation,this.monthlyPowerGeneraion=e.monthlyPowerGeneraion,this.regions=e.regions,angleToAzimuth=e.angleToAzimuth,this.selectedRegion=e.regions[8],generateUkraineMap(this),generateCompass(this.navigation),generatePowerChart(this.monthlyPowerGeneraion),generateAnglePicker(this.roofAngle),incomeGridApp.setDependency(this),complectationPricingApp.setPreferedPower(this.preferedPower)})}});vueMainInstances.push(calculatorApp);let localeApp=new Vue({el:"#locale-switch",data:{langs:[],selectedLang:""},computed:{selectedLangComp:{get:function(){return this.selectedLang},set:function(e){this.selectedLang=e,vueMainInstances.forEach(t=>{t.selectedLangComp&&(t.selectedLangComp=e)})}}},mounted(){this.langs=Object.keys(locales),this.selectedLangComp=window._defaultLocale}});$(document).ready(()=>{gridFirstYearDom=$("#income-grid-first-year"),gridYearlyDom=$("#income-grid-yearly"),grandSummaryDom=$("#income-grid-finance-graph"),initialDataDom=$("#income-grid-initial-data"),gridFirstYearDom.appear(),gridYearlyDom.appear(),grandSummaryDom.appear(),initialDataDom.appear(),gridFirstYearDom.on("appear",function(e,t){incomeGridApp.appearFirstYear(!0)}),gridFirstYearDom.on("disappear",function(e,t){incomeGridApp.appearFirstYear(!1)}),gridYearlyDom.on("appear",function(e,t){incomeGridApp.appearYearly(!0)}),gridYearlyDom.on("disappear",function(e,t){incomeGridApp.appearYearly(!1)}),grandSummaryDom.on("appear",function(e,t){incomeGridApp.appearGraph(!0)}),grandSummaryDom.on("disappear",function(e,t){incomeGridApp.appearGraph(!1)}),initialDataDom.on("appear",function(e,t){incomeGridApp.appearInitial(!0)}),initialDataDom.on("disappear",function(e,t){incomeGridApp.appearInitial(!1)}),incomeGridApp.appearFirstYear(gridFirstYearDom.is(":appeared")),incomeGridApp.appearYearly(gridYearlyDom.is(":appeared")),incomeGridApp.appearGraph(grandSummaryDom.is(":appeared")),incomeGridApp.appearInitial(initialDataDom.is(":appeared")),$.force_appear()});